{{ define "main" }}
{{ $LastUpdatedAt := (cond (ne .Params.updated_at nil) (time .Params.updated_at) .Date) -}}
<article class="">
  <header class="mb-4">
    <div class="meta">
      {{ if .Date -}}
      <span class="text-small text-gray">{{ .Date.Format "2006-01-02" }}</span>
        {{ if $LastUpdatedAt.After .Date -}}
        <span class="text-small text-gray">(Updated at: {{ (time .Params.updated_at).Format "2006-01-02" }})</span>
        {{ end -}}
      {{ end -}}
      {{ if .Params.tags -}}
      {{ end -}}
    </div>

    <div class="pagehead">
      <h1>{{ .Title | markdownify | emojify }}</h1>
    </div>

    <div>
      {{ range .Params.tags -}}
      {{ partial "tag.html" . -}}
      {{ end -}}
    </div>
  </header>

  {{ if ($LastUpdatedAt.AddDate 1 0 0).Before now }}
  <div class="mb-4 flash flash-warn">
    This post is possibly out of date.
  </div>
  {{ end }}

  <main class="markdown-body">
    {{ .Content }}
  </main>

  <section class="mt-4 d-flex flex-justify-between flex-content-center flex-item-center">
    <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-show-count="false">Tweet</a>
    <div class="mr-2"></div>
    <a href="https://b.hatena.ne.jp/entry/" class="hatena-bookmark-button" data-hatena-bookmark-layout="basic-label-counter" data-hatena-bookmark-lang="ja" title="このエントリーをはてなブックマークに追加"><img src="https://b.st-hatena.com/images/v4/public/entry-button/button-only@2x.png" alt="このエントリーをはてなブックマークに追加" width="20" height="20" style="border: none;" /></a>
    <div class="flex-auto"></div>
    <button class="btn btn-sm" onclick="window.scrollTo(0, 0);">Scroll to top</button>
  </section>

  <section class="mt-2">
    {{ template "_internal/disqus.html" . }}
  </section>

</article>

<script async crossorigin="anonymous" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<script type="text/javascript" src="https://b.st-hatena.com/js/bookmark_button.js" charset="utf-8" async="async"></script>
{{ end }}
