[{"object":"block","id":"6ff090fc-eba8-43d6-b757-73b8656cfdcc","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Angularの ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Angularの ","href":null},{"type":"text","text":{"content":"AsyncPipe","link":{"url":"https://angular.io/api/common/AsyncPipe"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"AsyncPipe","href":"https://angular.io/api/common/AsyncPipe"},{"type":"text","text":{"content":" は非同期データをテンプレートバインディングするのに便利な機能だが、実は実装当初からずっと大きな問題を抱えている。それが「初期値null問題」だ。 本稿ではAsyncPipeの初期値null問題とその根本的原因を解説し、この問題を解決するための新しい非同期データバインディングのあり方を論じる。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" は非同期データをテンプレートバインディングするのに便利な機能だが、実は実装当初からずっと大きな問題を抱えている。それが「初期値null問題」だ。 本稿ではAsyncPipeの初期値null問題とその根本的原因を解説し、この問題を解決するための新しい非同期データバインディングのあり方を論じる。","href":null}],"color":"default"}},{"object":"block","id":"abd41062-127e-4562-993d-c9b67432dc82","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"AsyncPipeの仕組みを理解する","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"AsyncPipeの仕組みを理解する","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"abc57074-4694-411b-b07c-24d0d8a49dd5","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"一般的なAngularアプリケーションを作る上でいまやAsyncPipeは必ず使われるものと言っても過言ではない。Observable型のデータを購読し、そのスナップショットをデータバインディングするために多用される。 基本的な使われ方は次のような形だ。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"一般的なAngularアプリケーションを作る上でいまやAsyncPipeは必ず使われるものと言っても過言ではない。Observable型のデータを購読し、そのスナップショットをデータバインディングするために多用される。 基本的な使われ方は次のような形だ。","href":null}],"color":"default"}},{"object":"block","id":"f339e808-eb57-4e62-82b7-591e66dca219","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:00:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"@Component({\n  selector: \"app-root\",\n  template: `\n    <div *ngIf=\"source$ | async as state\">\n      {{ state.count }}\n    </div>\n  `,\n  styleUrls: [\"./app.component.css\"]\n})\nexport class AppComponent {\n  source$ = interval(1000).pipe(map(i => ({ count: i })));\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"@Component({\n  selector: \"app-root\",\n  template: `\n    <div *ngIf=\"source$ | async as state\">\n      {{ state.count }}\n    </div>\n  `,\n  styleUrls: [\"./app.component.css\"]\n})\nexport class AppComponent {\n  source$ = interval(1000).pipe(map(i => ({ count: i })));\n}","href":null}],"language":"plain text"}},{"object":"block","id":"13987ffa-5707-46da-9da9-cd92d8e04bd3","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"さて、AsyncPipeはどのようにして、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"さて、AsyncPipeはどのようにして、 ","href":null},{"type":"text","text":{"content":"source$","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"source$","href":null},{"type":"text","text":{"content":" が流す値をテンプレートにバインディングし、レンダリングさせているのだろうか？ ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が流す値をテンプレートにバインディングし、レンダリングさせているのだろうか？ ","href":null},{"type":"text","text":{"content":"AsyncPipeの実装","link":{"url":"https://github.com/angular/angular/blob/9.0.1/packages/common/src/pipes/async_pipe.ts#L71"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"AsyncPipeの実装","href":"https://github.com/angular/angular/blob/9.0.1/packages/common/src/pipes/async_pipe.ts#L71"},{"type":"text","text":{"content":" を見てみよう。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を見てみよう。","href":null}],"color":"default"}},{"object":"block","id":"3e1771f7-72fa-44d8-a6dc-1ecbe80c4574","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"AsyncPipeはPromiseとObservableのどちらでも扱えるように非同期データの抽象化のコードが多いが、本質的な部分が次のコードだ。他のどのPipeとも同じく、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"AsyncPipeはPromiseとObservableのどちらでも扱えるように非同期データの抽象化のコードが多いが、本質的な部分が次のコードだ。他のどのPipeとも同じく、","href":null},{"type":"text","text":{"content":"transform()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"transform()","href":null},{"type":"text","text":{"content":"メソッドを実装している。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"メソッドを実装している。","href":null}],"color":"default"}},{"object":"block","id":"2f97e66d-ef4b-4716-96dd-b47a4bfa3f57","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:00:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"  transform(obj: Observable<any>|Promise<any>|null|undefined): any {\n    if (!this._obj) {\n      if (obj) {\n        this._subscribe(obj);\n      }\n      this._latestReturnedValue = this._latestValue;\n      return this._latestValue;\n    }\n\n    if (obj !== this._obj) {\n      this._dispose();\n      return this.transform(obj as any);\n    }\n\n    if (ɵlooseIdentical(this._latestValue, this._latestReturnedValue)) {\n      return this._latestReturnedValue;\n    }\n\n    this._latestReturnedValue = this._latestValue;\n    return WrappedValue.wrap(this._latestValue);\n  }","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"  transform(obj: Observable<any>|Promise<any>|null|undefined): any {\n    if (!this._obj) {\n      if (obj) {\n        this._subscribe(obj);\n      }\n      this._latestReturnedValue = this._latestValue;\n      return this._latestValue;\n    }\n\n    if (obj !== this._obj) {\n      this._dispose();\n      return this.transform(obj as any);\n    }\n\n    if (ɵlooseIdentical(this._latestValue, this._latestReturnedValue)) {\n      return this._latestReturnedValue;\n    }\n\n    this._latestReturnedValue = this._latestValue;\n    return WrappedValue.wrap(this._latestValue);\n  }","href":null}],"language":"plain text"}},{"object":"block","id":"35c7131d-bc43-4438-8ed2-3129d0ec22b3","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"上から順番に処理を見ていこう。最初の ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"上から順番に処理を見ていこう。最初の ","href":null},{"type":"text","text":{"content":"if (!this._obj)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"if (!this._obj)","href":null},{"type":"text","text":{"content":" は、AsyncPipeに初めてObservableが渡されたときの条件で、つまり初期化処理である。 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" は、AsyncPipeに初めてObservableが渡されたときの条件で、つまり初期化処理である。 ","href":null},{"type":"text","text":{"content":"this._obj","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"this._obj","href":null},{"type":"text","text":{"content":" がない かつ ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" がない かつ ","href":null},{"type":"text","text":{"content":"obj","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"obj","href":null},{"type":"text","text":{"content":" があれば、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" があれば、 ","href":null},{"type":"text","text":{"content":"obj","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"obj","href":null},{"type":"text","text":{"content":" を購読する。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を購読する。","href":null},{"type":"text","text":{"content":"obj","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"obj","href":null},{"type":"text","text":{"content":" が 最初の例の ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が 最初の例の ","href":null},{"type":"text","text":{"content":"source$","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"source$","href":null},{"type":"text","text":{"content":" にあたる。AsyncPipeに渡したObservableはここで ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" にあたる。AsyncPipeに渡したObservableはここで ","href":null},{"type":"text","text":{"content":"subscribe()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"subscribe()","href":null},{"type":"text","text":{"content":" される。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" される。","href":null}],"color":"default"}},{"object":"block","id":"ac5169ec-cc41-4e28-a3eb-77fe14e4035c","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"次のif文は 購読中のObservableとは別のObservableが渡されたときで、これは今の購読を disposeして、再購読を始めるようになっている。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"次のif文は 購読中のObservableとは別のObservableが渡されたときで、これは今の購読を disposeして、再購読を始めるようになっている。","href":null}],"color":"default"}},{"object":"block","id":"d1549328-b28c-45ec-87d7-8802bee965fa","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"そして残りのコードで、購読中のObservableから得られた最新の値 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"そして残りのコードで、購読中のObservableから得られた最新の値 ","href":null},{"type":"text","text":{"content":"this._latestValue","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"this._latestValue","href":null},{"type":"text","text":{"content":" をreturnしている。returnされた値が、実際にテンプレートのレンダリングに使われる値になる。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" をreturnしている。returnされた値が、実際にテンプレートのレンダリングに使われる値になる。","href":null}],"color":"default"}},{"object":"block","id":"c38234e7-c1fb-45da-9921-00275f0b852a","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ここからわかることは、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ここからわかることは、","href":null},{"type":"text","text":{"content":"AsyncPipeは ","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"AsyncPipeは ","href":null},{"type":"text","text":{"content":"transform()","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"transform()","href":null},{"type":"text","text":{"content":"メソッドが呼び出されたときにキャッシュしている ","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"メソッドが呼び出されたときにキャッシュしている ","href":null},{"type":"text","text":{"content":"this._latestValue","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"this._latestValue","href":null},{"type":"text","text":{"content":" を返している","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を返している","href":null},{"type":"text","text":{"content":" ということだ。 このことはAsyncPipeの ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" ということだ。 このことはAsyncPipeの ","href":null},{"type":"text","text":{"content":"_subscribe()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"_subscribe()","href":null},{"type":"text","text":{"content":" メソッドと ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" メソッドと ","href":null},{"type":"text","text":{"content":"this._updateLatestValue()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"this._updateLatestValue()","href":null},{"type":"text","text":{"content":" メソッドを見てもわかる。 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" メソッドを見てもわかる。 ","href":null},{"type":"text","text":{"content":"_subscribe()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"_subscribe()","href":null},{"type":"text","text":{"content":"メソッドで購読した非同期データに値が流れてきたら、そのコールバックで ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"メソッドで購読した非同期データに値が流れてきたら、そのコールバックで ","href":null},{"type":"text","text":{"content":"ChangeDetectorRef","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"ChangeDetectorRef","href":null},{"type":"text","text":{"content":" の ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の ","href":null},{"type":"text","text":{"content":"markForCheck()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"markForCheck()","href":null},{"type":"text","text":{"content":" が呼び出される。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が呼び出される。","href":null}],"color":"default"}},{"object":"block","id":"e9cdc87c-f552-4d30-9d2c-5720037ccf88","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:00:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"  private _subscribe(obj: Observable<any>|Promise<any>|EventEmitter<any>): void {\n    this._obj = obj;\n    this._strategy = this._selectStrategy(obj);\n    this._subscription = this._strategy.createSubscription(\n        obj, (value: Object) => this._updateLatestValue(obj, value));\n  }\n  ...\n  private _updateLatestValue(async: any, value: Object): void {\n    if (async === this._obj) {\n      this._latestValue = value;\n      this._ref.markForCheck();\n    }\n  }","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"  private _subscribe(obj: Observable<any>|Promise<any>|EventEmitter<any>): void {\n    this._obj = obj;\n    this._strategy = this._selectStrategy(obj);\n    this._subscription = this._strategy.createSubscription(\n        obj, (value: Object) => this._updateLatestValue(obj, value));\n  }\n  ...\n  private _updateLatestValue(async: any, value: Object): void {\n    if (async === this._obj) {\n      this._latestValue = value;\n      this._ref.markForCheck();\n    }\n  }","href":null}],"language":"plain text"}},{"object":"block","id":"9fba9b17-488d-47ff-98c1-f1507513c76b","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"つまり、AsyncPipeは次のような仕組みでテンプレートをレンダリングしている。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"つまり、AsyncPipeは次のような仕組みでテンプレートをレンダリングしている。","href":null}],"color":"default"}},{"object":"block","id":"afa9ae90-8dfd-4cf9-802d-a17bee8e31a8","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"numbered_list_item","numbered_list_item":{"rich_text":[{"type":"text","text":{"content":"Change DetectionでPipeの ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Change DetectionでPipeの ","href":null},{"type":"text","text":{"content":"transform()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"transform()","href":null},{"type":"text","text":{"content":" が呼び出される","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が呼び出される","href":null}],"color":"default"}},{"object":"block","id":"b1b1c52b-52ac-4e8a-bd89-9848b7ae7c72","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"numbered_list_item","numbered_list_item":{"rich_text":[{"type":"text","text":{"content":"渡されたObservableの購読を開始する","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"渡されたObservableの購読を開始する","href":null}],"color":"default"}},{"object":"block","id":"c77637ef-e3c9-4bb5-8471-4b863d9002f9","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"numbered_list_item","numbered_list_item":{"rich_text":[{"type":"text","text":{"content":"transform()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"transform()","href":null},{"type":"text","text":{"content":" が呼び出された時点の ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が呼び出された時点の ","href":null},{"type":"text","text":{"content":"this._latestValue","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"this._latestValue","href":null},{"type":"text","text":{"content":" を 返して終了する","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を 返して終了する","href":null}],"color":"default"}},{"object":"block","id":"f1fff352-c3a7-4661-ae07-f73cb5d6e2ca","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"numbered_list_item","numbered_list_item":{"rich_text":[{"type":"text","text":{"content":"Observableが値を流したら ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Observableが値を流したら ","href":null},{"type":"text","text":{"content":"this._latestValue","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"this._latestValue","href":null},{"type":"text","text":{"content":" を更新して Change Detectionをトリガーする（1に戻る）","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を更新して Change Detectionをトリガーする（1に戻る）","href":null}],"color":"default"}},{"object":"block","id":"5c9b9964-b12f-40c6-a493-44f85f9388f9","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"テンプレートが最終的に同期的な値しかレンダリングできない以上、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"テンプレートが最終的に同期的な値しかレンダリングできない以上、 ","href":null},{"type":"text","text":{"content":"transform()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"transform()","href":null},{"type":"text","text":{"content":" は同期的な値を返す必要があり、それは ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" は同期的な値を返す必要があり、それは ","href":null},{"type":"text","text":{"content":"transform()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"transform()","href":null},{"type":"text","text":{"content":" が呼ばれたタイミングでのスナップショットを返すことしかできないのだ。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が呼ばれたタイミングでのスナップショットを返すことしかできないのだ。","href":null}],"color":"default"}},{"object":"block","id":"30f6fd0d-5913-4ba7-9a77-8ec7a7d4036a","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ここまでをしっかり理解すると、ある疑問が生まれるはずだ。それは、「購読を開始するタイミングの ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ここまでをしっかり理解すると、ある疑問が生まれるはずだ。それは、「購読を開始するタイミングの ","href":null},{"type":"text","text":{"content":"transform()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"transform()","href":null},{"type":"text","text":{"content":" は値を返せないんじゃないか？」ということだ。そしてそれこそがAsyncPipeが抱える最大の課題である「初期値null問題」につながる。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" は値を返せないんじゃないか？」ということだ。そしてそれこそがAsyncPipeが抱える最大の課題である「初期値null問題」につながる。","href":null}],"color":"default"}},{"object":"block","id":"970d61fa-fc89-4922-917d-2210f4d7fa60","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"初期値null問題","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"初期値null問題","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"b88f55a7-a027-4b63-9e40-f81e9000e51e","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"this._latestValue","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"this._latestValue","href":null},{"type":"text","text":{"content":"はObservableの購読コールバックで値がセットされるのだから、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"はObservableの購読コールバックで値がセットされるのだから、 ","href":null},{"type":"text","text":{"content":"transform()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"transform()","href":null},{"type":"text","text":{"content":" の呼び出し時点ではまだ一度も値がセットされていない。しかし、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の呼び出し時点ではまだ一度も値がセットされていない。しかし、","href":null},{"type":"text","text":{"content":"transform()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"transform()","href":null},{"type":"text","text":{"content":"はかならず何かしら値を返さなければならないので、規定の初期値を返すようになっている。 もう一度 AsyncPipeの ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"はかならず何かしら値を返さなければならないので、規定の初期値を返すようになっている。 もう一度 AsyncPipeの ","href":null},{"type":"text","text":{"content":"transform()","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"transform()","href":null},{"type":"text","text":{"content":" の冒頭を見てみよう。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の冒頭を見てみよう。","href":null}],"color":"default"}},{"object":"block","id":"76092d15-9a03-491c-b182-08a13ac80084","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:00:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"    if (!this._obj) {\n      if (obj) {\n        this._subscribe(obj);\n      }\n      this._latestReturnedValue = this._latestValue;\n      return this._latestValue;\n    }","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"    if (!this._obj) {\n      if (obj) {\n        this._subscribe(obj);\n      }\n      this._latestReturnedValue = this._latestValue;\n      return this._latestValue;\n    }","href":null}],"language":"plain text"}},{"object":"block","id":"81255726-2d0c-4566-a711-8951e44cb27e","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"最後の2行で使われている ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"最後の2行で使われている ","href":null},{"type":"text","text":{"content":"this._latestValue","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"this._latestValue","href":null},{"type":"text","text":{"content":" は一度も値がセットされていないので、このフィールドの初期値が使われることになる。その値が ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" は一度も値がセットされていないので、このフィールドの初期値が使われることになる。その値が ","href":null},{"type":"text","text":{"content":"null","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"null","href":null},{"type":"text","text":{"content":" なのだ。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" なのだ。","href":null}],"color":"default"}},{"object":"block","id":"5eeda4a7-111c-4559-88a6-57d1479d5b58","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:01:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"export class AsyncPipe implements OnDestroy, PipeTransform {\n  private _latestValue: any = null;\n  private _latestReturnedValue: any = null;","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"export class AsyncPipe implements OnDestroy, PipeTransform {\n  private _latestValue: any = null;\n  private _latestReturnedValue: any = null;","href":null}],"language":"plain text"}},{"object":"block","id":"f0b05c4a-cb94-44df-bb11-0643e5730e9c","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"つまり、AsyncPipeは購読したObservableが最初の値を流す前に、必ず一度 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"つまり、AsyncPipeは購読したObservableが最初の値を流す前に、必ず一度 ","href":null},{"type":"text","text":{"content":"null","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"null","href":null},{"type":"text","text":{"content":" を返すようにできているのだ。もとのObservableが ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を返すようにできているのだ。もとのObservableが ","href":null},{"type":"text","text":{"content":"Observable<State>","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"Observable<State>","href":null},{"type":"text","text":{"content":" だったとしても、 AsyncPipeを通すと ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" だったとしても、 AsyncPipeを通すと ","href":null},{"type":"text","text":{"content":"State | null","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"State | null","href":null},{"type":"text","text":{"content":" となってしまう、これを「初期値null問題」と呼んでいる。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" となってしまう、これを「初期値null問題」と呼んでいる。","href":null}],"color":"default"}},{"object":"block","id":"b0a2fcc1-5374-4dc5-a915-e18f4599b29e","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"この問題は深刻そうに思えるが、実は多くのケースで自動的に回避されている。それはAsyncPipeとよく併用される ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"この問題は深刻そうに思えるが、実は多くのケースで自動的に回避されている。それはAsyncPipeとよく併用される ","href":null},{"type":"text","text":{"content":"*ngIf","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"*ngIf","href":null},{"type":"text","text":{"content":" と ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" と ","href":null},{"type":"text","text":{"content":"*ngFor","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"*ngFor","href":null},{"type":"text","text":{"content":" が、AsyncPipeから返される ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が、AsyncPipeから返される ","href":null},{"type":"text","text":{"content":"null","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"null","href":null},{"type":"text","text":{"content":" を無視するようになっているからだ。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を無視するようになっているからだ。","href":null}],"color":"default"}},{"object":"block","id":"e695c091-307f-40fe-a6f4-0c6fd2a19678","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"次のテンプレートでは、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"次のテンプレートでは、 ","href":null},{"type":"text","text":{"content":"source$ | async","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"source$ | async","href":null},{"type":"text","text":{"content":" が返した値を NgIfディレクティブが評価して、Truthyならレンダリングされるため、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が返した値を NgIfディレクティブが評価して、Truthyならレンダリングされるため、 ","href":null},{"type":"text","text":{"content":"null","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"null","href":null},{"type":"text","text":{"content":" のときは ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" のときは ","href":null},{"type":"text","text":{"content":"*ngIf","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"*ngIf","href":null},{"type":"text","text":{"content":" の内側に入ることはない。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の内側に入ることはない。","href":null}],"color":"default"}},{"object":"block","id":"4792880d-8570-4767-9d75-266b5e53808b","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"<div *ngIf=\"source$ | async as state\">  {{ state.count }}</div>","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<div *ngIf=\"source$ | async as state\">  {{ state.count }}</div>","href":null}],"language":"html"}},{"object":"block","id":"5bf6c68a-772d-443c-8e4a-93b8690d8709","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"同様に次のテンプレートでは、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"同様に次のテンプレートでは、 ","href":null},{"type":"text","text":{"content":"source$ | async","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"source$ | async","href":null},{"type":"text","text":{"content":" が返した値を NgForディレクティブが評価して、Falsyなら無視されるため、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が返した値を NgForディレクティブが評価して、Falsyなら無視されるため、 ","href":null},{"type":"text","text":{"content":"null","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"null","href":null},{"type":"text","text":{"content":" のときは ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" のときは ","href":null},{"type":"text","text":{"content":"*ngFor","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"*ngFor","href":null},{"type":"text","text":{"content":" の内側に入ることはない。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の内側に入ることはない。","href":null}],"color":"default"}},{"object":"block","id":"007ca09a-7301-4b69-8f5c-c965266338e7","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"<div *ngFor=\"let item of source$ | async\">  {{ item }}</div>","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<div *ngFor=\"let item of source$ | async\">  {{ item }}</div>","href":null}],"language":"html"}},{"object":"block","id":"394bc45e-7414-48eb-a4d3-a0b9b4b6174d","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"ngIf","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"ngIf","href":null},{"type":"text","text":{"content":" や ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" や ","href":null},{"type":"text","text":{"content":"ngFor","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"ngFor","href":null},{"type":"text","text":{"content":" のような null安全なディレクティブを通してあれば、初期値null問題がアプリケーションに影響を与えることはない。問題はそうではない場合、つまり、子コンポーネントのInputに直接AsyncPipeで値を渡しているケースだ。 次のようなケースで、子コンポーネントは ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" のような null安全なディレクティブを通してあれば、初期値null問題がアプリケーションに影響を与えることはない。問題はそうではない場合、つまり、子コンポーネントのInputに直接AsyncPipeで値を渡しているケースだ。 次のようなケースで、子コンポーネントは ","href":null},{"type":"text","text":{"content":"prop","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"prop","href":null},{"type":"text","text":{"content":" Inputの型を定義してあるはずだが、そこには ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" Inputの型を定義してあるはずだが、そこには ","href":null},{"type":"text","text":{"content":"null","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"null","href":null},{"type":"text","text":{"content":" が渡される可能性を考慮しなくてはならない。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" が渡される可能性を考慮しなくてはならない。","href":null},{"type":"text","text":{"content":"prop","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"prop","href":null},{"type":"text","text":{"content":" がgetterやsetterであった場合、値にアクセスしようとして実行時エラーが発生することは容易に想像できる。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" がgetterやsetterであった場合、値にアクセスしようとして実行時エラーが発生することは容易に想像できる。","href":null}],"color":"default"}},{"object":"block","id":"c3a02013-62ef-4196-a262-b21e4e1fc953","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"<child [prop]=\"source$ | async\"></child>","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<child [prop]=\"source$ | async\"></child>","href":null}],"language":"html"}},{"object":"block","id":"a284f25e-e591-4a9a-8210-abbdbf8efe84","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ここまでの話で、簡単なベストプラクティスとして言えることはひとつ。 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ここまでの話で、簡単なベストプラクティスとして言えることはひとつ。 ","href":null},{"type":"text","text":{"content":"AsyncPipeは常にNgIfやNgForによるnull安全なガードを通して利用すべきである","link":null},"annotations":{"bold":true,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"AsyncPipeは常にNgIfやNgForによるnull安全なガードを通して利用すべきである","href":null},{"type":"text","text":{"content":"。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"。","href":null}],"color":"default"}},{"object":"block","id":"35c106ae-fb20-434d-95b9-363dbebac268","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"AsyncPipeを置き換える","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"AsyncPipeを置き換える","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"ff9f30b7-4d07-45ab-9625-c555f106ae96","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ここからは後編、上述の課題を抱えたAsyncPipeを置き換えられる新しい非同期データバインディングのあり方を模索する。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ここからは後編、上述の課題を抱えたAsyncPipeを置き換えられる新しい非同期データバインディングのあり方を模索する。","href":null}],"color":"default"}},{"object":"block","id":"f3a426a3-4cdd-4fff-887d-65674415bf3a","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"なぜAsyncPipeが ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"なぜAsyncPipeが ","href":null},{"type":"text","text":{"content":"null","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"null","href":null},{"type":"text","text":{"content":" を返すことになったのか、それはPipeが同期的な値を返す必要があるからである。初期値null問題を解決するにはPipeをやめるしかない。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を返すことになったのか、それはPipeが同期的な値を返す必要があるからである。初期値null問題を解決するにはPipeをやめるしかない。","href":null}],"color":"default"}},{"object":"block","id":"86f5cc28-b54d-4887-abb2-55fb73dd836a","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"そこでディレクティブを使ってみようと思う。 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"そこでディレクティブを使ってみようと思う。 ","href":null},{"type":"text","text":{"content":"*ngFor","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"*ngFor","href":null},{"type":"text","text":{"content":" のように、Inputとテンプレートを受け取って、ディレクティブの裁量でテンプレートをレンダリングできるアプローチが、AsyncPipeを置き換えるには最適である。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" のように、Inputとテンプレートを受け取って、ディレクティブの裁量でテンプレートをレンダリングできるアプローチが、AsyncPipeを置き換えるには最適である。","href":null}],"color":"default"}},{"object":"block","id":"2188c4f2-b85b-4bbe-9f74-4dab868f46e6","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"そこで筆者が実装したのが ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"そこで筆者が実装したのが ","href":null},{"type":"text","text":{"content":"*rxSubscribe","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"*rxSubscribe","href":null},{"type":"text","text":{"content":" ディレクティブだ。実際に動作するサンプルは","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" ディレクティブだ。実際に動作するサンプルは","href":null},{"type":"text","text":{"content":"こちら","link":{"url":"https://stackblitz.com/edit/github-zg4qep"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"こちら","href":"https://stackblitz.com/edit/github-zg4qep"},{"type":"text","text":{"content":"。次のように構造ディレクティブでObservableを購読する。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"。次のように構造ディレクティブでObservableを購読する。","href":null}],"color":"default"}},{"object":"block","id":"d420ddff-a98d-4045-aa84-a65d22837c4a","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"<div *rxSubscribe=\"source$; let state\">  {{ state.count }}</div>","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<div *rxSubscribe=\"source$; let state\">  {{ state.count }}</div>","href":null}],"language":"html"}},{"object":"block","id":"6aaef65b-4d12-4764-ba3e-78523515d3b6","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ディレクティブは次のような実装になっている。このディレクティブがおこなうことは、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ディレクティブは次のような実装になっている。このディレクティブがおこなうことは、","href":null}],"color":"default"}},{"object":"block","id":"2d86a10b-3178-4d09-bb66-d1e094f00b71","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"numbered_list_item","numbered_list_item":{"rich_text":[{"type":"text","text":{"content":"rxSubscribe","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"rxSubscribe","href":null},{"type":"text","text":{"content":" Inputで受け取ったObservableを ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" Inputで受け取ったObservableを ","href":null},{"type":"text","text":{"content":"ngOnInit","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"ngOnInit","href":null},{"type":"text","text":{"content":" で購読する。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" で購読する。","href":null}],"color":"default"}},{"object":"block","id":"91895306-4ae6-448b-803f-1a84a1778c41","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"numbered_list_item","numbered_list_item":{"rich_text":[{"type":"text","text":{"content":"Observableが値を流したら、初回はテンプレートをEmbedする（レンダリングする）","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Observableが値を流したら、初回はテンプレートをEmbedする（レンダリングする）","href":null}],"color":"default"}},{"object":"block","id":"31accb4f-d82c-4efb-8989-3c219d91505c","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"numbered_list_item","numbered_list_item":{"rich_text":[{"type":"text","text":{"content":"2回め以降の値が流れてきたら、contextを更新して ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"2回め以降の値が流れてきたら、contextを更新して ","href":null},{"type":"text","text":{"content":"markForCheck","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"markForCheck","href":null},{"type":"text","text":{"content":" を呼び出す","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" を呼び出す","href":null}],"color":"default"}},{"object":"block","id":"ec627386-3054-407b-a77e-96db240d30e3","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:01:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"https://github.com/lacolaco/ngivy-rx-subscribe-directive/blob/master/src/app/rx-subscribe.directive.ts","link":{"url":"https://github.com/lacolaco/ngivy-rx-subscribe-directive/blob/master/src/app/rx-subscribe.directive.ts"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://github.com/lacolaco/ngivy-rx-subscribe-directive/blob/master/src/app/rx-subscribe.directive.ts","href":"https://github.com/lacolaco/ngivy-rx-subscribe-directive/blob/master/src/app/rx-subscribe.directive.ts"},{"type":"text","text":{"content":" ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" ","href":null}],"color":"default"}},{"object":"block","id":"d878985f-016d-4e0c-b3e5-b9675cbf0ad9","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:01:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"@Directive({\n  selector: \"[rxSubscribe]\"\n})\nexport class RxSubscribeDirective<T> implements OnInit, OnDestroy {\n  constructor(\n    private vcRef: ViewContainerRef,\n    private templateRef: TemplateRef<RxSubscribeFromContext<T>>\n  ) {}\n  @Input(\"rxSubscribe\")\n  source$: Observable<T>;\n\n  ngOnInit() {\n    let viewRef: EmbeddedViewRef<RxSubscribeFromContext<T>>;\n    this.source$.pipe(takeUntil(this.onDestroy$)).subscribe(source => {\n      if (!viewRef) {\n        viewRef = this.vcRef.createEmbeddedView(this.templateRef, {\n          $implicit: source\n        });\n      } else {\n        viewRef.context.$implicit = source;\n        viewRef.markForCheck();\n      }\n    });\n  }\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"@Directive({\n  selector: \"[rxSubscribe]\"\n})\nexport class RxSubscribeDirective<T> implements OnInit, OnDestroy {\n  constructor(\n    private vcRef: ViewContainerRef,\n    private templateRef: TemplateRef<RxSubscribeFromContext<T>>\n  ) {}\n  @Input(\"rxSubscribe\")\n  source$: Observable<T>;\n\n  ngOnInit() {\n    let viewRef: EmbeddedViewRef<RxSubscribeFromContext<T>>;\n    this.source$.pipe(takeUntil(this.onDestroy$)).subscribe(source => {\n      if (!viewRef) {\n        viewRef = this.vcRef.createEmbeddedView(this.templateRef, {\n          $implicit: source\n        });\n      } else {\n        viewRef.context.$implicit = source;\n        viewRef.markForCheck();\n      }\n    });\n  }\n}","href":null}],"language":"plain text"}},{"object":"block","id":"880e89fb-0e0b-454d-8f65-1c9f9e976364","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"このアプローチであれば、最初に値が流れてくるまではテンプレートは描画されず、値が流れてきたタイミングでだけ再レンダリングをトリガーできる。初期値null問題を解決し、さらに再レンダリングも必要なときだけに絞られるのでCPUにもやさしい。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"このアプローチであれば、最初に値が流れてくるまではテンプレートは描画されず、値が流れてきたタイミングでだけ再レンダリングをトリガーできる。初期値null問題を解決し、さらに再レンダリングも必要なときだけに絞られるのでCPUにもやさしい。","href":null}],"color":"default"}},{"object":"block","id":"3cba1124-9ca2-4541-8dce-7b1c30984d93","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ちなみに 冒頭のテンプレートでの、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ちなみに 冒頭のテンプレートでの、 ","href":null},{"type":"text","text":{"content":"let state","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"let state","href":null},{"type":"text","text":{"content":" の ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の ","href":null},{"type":"text","text":{"content":"state","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"state","href":null},{"type":"text","text":{"content":" の型は、Angular v9のIvy以降ならきっちりと ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の型は、Angular v9のIvy以降ならきっちりと ","href":null},{"type":"text","text":{"content":"source$","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"source$","href":null},{"type":"text","text":{"content":" の型から推論され、 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の型から推論され、 ","href":null},{"type":"text","text":{"content":"strictTemplates","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"strictTemplates","href":null},{"type":"text","text":{"content":" フラグが有効ならば ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" フラグが有効ならば ","href":null},{"type":"text","text":{"content":"state","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"state","href":null},{"type":"text","text":{"content":" の使い方を間違えれば AOTコンパイルでエラーになる。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の使い方を間違えれば AOTコンパイルでエラーになる。","href":null}],"color":"default"}},{"object":"block","id":"3650484c-7ac0-49d0-bab2-20e62f6ba99b","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:01:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"<div *rxSubscribe=\"source$; let state\">\n  {{ state.foo }}  <!-- stateは `foo` を持たないためAOTコンパイルエラーになる -->\n</div>","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"<div *rxSubscribe=\"source$; let state\">\n  {{ state.foo }}  <!-- stateは `foo` を持たないためAOTコンパイルエラーになる -->\n</div>","href":null}],"language":"html"}},{"object":"block","id":"278c210d-6591-400a-83fe-e020c2a293bf","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"AsyncPipeでは初期値null問題によって常に ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"AsyncPipeでは初期値null問題によって常に ","href":null},{"type":"text","text":{"content":"or null","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"or null","href":null},{"type":"text","text":{"content":" の推論しかできなかったが、構造ディレクティブのアプローチなら ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の推論しかできなかったが、構造ディレクティブのアプローチなら ","href":null},{"type":"text","text":{"content":"Observable<T>","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"Observable<T>","href":null},{"type":"text","text":{"content":" に対して 正確に推論できる。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" に対して 正確に推論できる。","href":null}],"color":"default"}},{"object":"block","id":"bf21f982-ba75-4869-866a-9a644e24c821","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ちなみに、この ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ちなみに、この ","href":null},{"type":"text","text":{"content":"*rxSubscribe","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"*rxSubscribe","href":null},{"type":"text","text":{"content":" ディレクティブは ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" ディレクティブは ","href":null},{"type":"text","text":{"content":"@soundng/rx-subscribe","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"@soundng/rx-subscribe","href":null},{"type":"text","text":{"content":" というnpmパッケージで公開している。ぜひ使ってみてほしい。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" というnpmパッケージで公開している。ぜひ使ってみてほしい。","href":null}],"color":"default"}},{"object":"block","id":"f3a0efe6-4444-458f-91c9-bca63f04d76b","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:01:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"GitHub ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"GitHub ","href":null},{"type":"text","text":{"content":"https://github.com/soundng/rx-subscribe","link":{"url":"https://github.com/soundng/rx-subscribe"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://github.com/soundng/rx-subscribe","href":"https://github.com/soundng/rx-subscribe"},{"type":"text","text":{"content":" ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" ","href":null}],"color":"default"}},{"object":"block","id":"070ecace-caab-466d-bd14-828b32aa5d09","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:01:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"NPM ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"NPM ","href":null},{"type":"text","text":{"content":"https://www.npmjs.com/package/@soundng/rx-subscribe","link":{"url":"https://www.npmjs.com/package/@soundng/rx-subscribe"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://www.npmjs.com/package/@soundng/rx-subscribe","href":"https://www.npmjs.com/package/@soundng/rx-subscribe"},{"type":"text","text":{"content":" ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" ","href":null}],"color":"default"}},{"object":"block","id":"8efde241-30ea-4077-8b04-39cb06b79fe5","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T05:01:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"Demo ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Demo ","href":null},{"type":"text","text":{"content":"https://stackblitz.com/edit/github-zg4qep-kq9pyw?file=src/app/app.component.html","link":{"url":"https://stackblitz.com/edit/github-zg4qep-kq9pyw?file=src%2Fapp%2Fapp.component.html"}},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"https://stackblitz.com/edit/github-zg4qep-kq9pyw?file=src/app/app.component.html","href":"https://stackblitz.com/edit/github-zg4qep-kq9pyw?file=src%2Fapp%2Fapp.component.html"},{"type":"text","text":{"content":" ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" ","href":null}],"color":"default"}},{"object":"block","id":"e9c5ec93-8b62-4ef0-9301-bc00daf756b4","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"heading_2","heading_2":{"rich_text":[{"type":"text","text":{"content":"まとめ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"まとめ","href":null}],"is_toggleable":false,"color":"default"}},{"object":"block","id":"95534238-a69d-445e-a13f-946284d8ea65","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"AsyncPipeには初期値null問題がある","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"AsyncPipeには初期値null問題がある","href":null}],"color":"default"}},{"object":"block","id":"1860f906-471b-4c5c-b324-1d74dc155a33","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"NgIfやNgForでガードすれば影響はない","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"NgIfやNgForでガードすれば影響はない","href":null}],"color":"default"}},{"object":"block","id":"4e4f0866-bf16-4659-93ad-863be83a35b9","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"非同期データを扱うにはPipeの限界がある","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"非同期データを扱うにはPipeの限界がある","href":null}],"color":"default"}},{"object":"block","id":"8c14d1b0-638f-4b94-b1f9-0690c01d91a3","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"構造ディレクティブによるアプローチはAsyncPipeの問題を解決できる","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"構造ディレクティブによるアプローチはAsyncPipeの問題を解決できる","href":null}],"color":"default"}},{"object":"block","id":"bcf0bde5-3906-47ec-9358-f844f7a25191","parent":{"type":"page_id","page_id":"289a7964-b989-4c20-818f-45f429907bd1"},"created_time":"2023-05-21T00:20:00.000Z","last_edited_time":"2023-05-21T00:20:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bulleted_list_item","bulleted_list_item":{"rich_text":[{"type":"text","text":{"content":"@soundng/rx-subscribe","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"@soundng/rx-subscribe","href":null},{"type":"text","text":{"content":" へのフィードバック歓迎","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" へのフィードバック歓迎","href":null}],"color":"default"}}]