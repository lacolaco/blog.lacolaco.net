[{"object":"block","id":"92653ad1-249a-437d-be8a-edf9ffdd4674","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:35:00.000Z","last_edited_time":"2023-12-27T05:40:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ブログ記事中の画像を表示するために、Astroの画像最適化機能を使うようにした。これまではオリジナルの画像をそのまま","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ブログ記事中の画像を表示するために、Astroの画像最適化機能を使うようにした。これまではオリジナルの画像をそのまま","href":null},{"type":"text","text":{"content":"img","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"img","href":null},{"type":"text","text":{"content":"タグに渡しており、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"タグに渡しており、","href":null},{"type":"text","text":{"content":"width","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"width","href":null},{"type":"text","text":{"content":"や","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"や","href":null},{"type":"text","text":{"content":"height","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"height","href":null},{"type":"text","text":{"content":"も設定していなかったため、読み込みパフォーマンスの面でもレイアウトシフトの面でも問題があったが、手抜きで放置していた。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"も設定していなかったため、読み込みパフォーマンスの面でもレイアウトシフトの面でも問題があったが、手抜きで放置していた。","href":null}],"color":"default"}},{"object":"block","id":"ad0a4d10-b5c8-48f5-b8f9-d3ca61dc916e","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:40:00.000Z","last_edited_time":"2023-12-27T05:40:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[],"color":"default"}},{"object":"block","id":"095533b8-b788-4c99-b528-ea655d8a00d6","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:40:00.000Z","last_edited_time":"2023-12-27T05:45:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"Astroの画像最適化は、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"Astroの画像最適化は、","href":null},{"type":"text","text":{"content":"Image","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"Image","href":null},{"type":"text","text":{"content":"コンポーネントを使うのが簡単だ。だが、ブログの作りの上で工夫が必要な点があった。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"コンポーネントを使うのが簡単だ。だが、ブログの作りの上で工夫が必要な点があった。","href":null}],"color":"default"}},{"object":"block","id":"25ca0a62-2d53-4e08-a19e-e335a646c2f4","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:40:00.000Z","last_edited_time":"2023-12-27T05:40:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bookmark","bookmark":{"caption":[],"url":"https://docs.astro.build/ja/guides/images/"}},{"object":"block","id":"64499527-6b0b-4fb6-85a2-8822348be0fb","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:39:00.000Z","last_edited_time":"2023-12-27T05:49:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ブログ記事中の画像は外部URLで配信されているものと、CMS（Notion）で管理しているローカル管理のものがある。今回はローカル管理のものに限って","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ブログ記事中の画像は外部URLで配信されているものと、CMS（Notion）で管理しているローカル管理のものがある。今回はローカル管理のものに限って","href":null},{"type":"text","text":{"content":"Image","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"Image","href":null},{"type":"text","text":{"content":"コンポーネントを使うようにした。外部URLのものはせめてもの最適化ということで","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"コンポーネントを使うようにした。外部URLのものはせめてもの最適化ということで","href":null},{"type":"text","text":{"content":"decoding=\"async”","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"decoding=\"async”","href":null},{"type":"text","text":{"content":"だけは有効にした。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"だけは有効にした。","href":null}],"color":"default"}},{"object":"block","id":"322a6907-9334-4031-b426-1d2d9cbb7c7f","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:49:00.000Z","last_edited_time":"2023-12-27T05:49:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bookmark","bookmark":{"caption":[],"url":"https://developer.mozilla.org/ja/docs/Web/API/HTMLImageElement/decoding"}},{"object":"block","id":"61b35204-93e8-4c7f-8977-f965994240a0","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:47:00.000Z","last_edited_time":"2023-12-27T05:48:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"{\n  external ? (\n    <img src={url} decoding=\"async\" />\n  ) : (\n    <AstroImage\n      src={images[url]()}\n    />\n  )\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"{\n  external ? (\n    <img src={url} decoding=\"async\" />\n  ) : (\n    <AstroImage\n      src={images[url]()}\n    />\n  )\n}","href":null}],"language":"typescript"}},{"object":"block","id":"5396b115-d7f0-4a0f-b829-dc08b3a83258","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:49:00.000Z","last_edited_time":"2023-12-27T05:49:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[],"color":"default"}},{"object":"block","id":"9fb82dd3-5c03-45ff-b632-6ba7657338d8","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:49:00.000Z","last_edited_time":"2023-12-27T05:57:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ローカル画像のほうは、次のガイドを参考に動的読み込みを使って解決した。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ローカル画像のほうは、次のガイドを参考に動的読み込みを使って解決した。","href":null}],"color":"default"}},{"object":"block","id":"7b63eec5-cce5-4b0a-ac75-3730a08b5014","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:57:00.000Z","last_edited_time":"2023-12-27T05:57:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"bookmark","bookmark":{"caption":[],"url":"https://docs.astro.build/ja/recipes/dynamically-importing-images/"}},{"object":"block","id":"0c286067-08d7-4f2f-878b-8119b91adb55","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:58:00.000Z","last_edited_time":"2023-12-27T05:58:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"code","code":{"caption":[],"rich_text":[{"type":"text","text":{"content":"const images = import.meta.glob<{ default: ImageMetadata }>('/src/content/images/**/*.{jpg,jpeg,png,gif,svg}');\nif (!external && !images[url]) {\n  throw new Error(`\"${url}\" does not exist in glob: \"src/content/images/**/*\"`);\n}","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"const images = import.meta.glob<{ default: ImageMetadata }>('/src/content/images/**/*.{jpg,jpeg,png,gif,svg}');\nif (!external && !images[url]) {\n  throw new Error(`\"${url}\" does not exist in glob: \"src/content/images/**/*\"`);\n}","href":null}],"language":"typescript"}},{"object":"block","id":"6187bfdc-ed0f-47bd-a176-8dff893845f6","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T05:58:00.000Z","last_edited_time":"2023-12-27T06:02:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"はじめは直接 ","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"はじめは直接 ","href":null},{"type":"text","text":{"content":"import(url)","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"import(url)","href":null},{"type":"text","text":{"content":" の戻り値をImageコンポーネントに渡していたが、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":" の戻り値をImageコンポーネントに渡していたが、","href":null},{"type":"text","text":{"content":"astro dev","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"astro dev","href":null},{"type":"text","text":{"content":"では読み込めるものの、","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"では読み込めるものの、","href":null},{"type":"text","text":{"content":"astro build","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"astro build","href":null},{"type":"text","text":{"content":"すると画像ファイルの読み込みに失敗した。Viteの内部的なビルドシステムに起因してそうだ。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"すると画像ファイルの読み込みに失敗した。Viteの内部的なビルドシステムに起因してそうだ。","href":null},{"type":"text","text":{"content":"import.meta.glob","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":true,"color":"default"},"plain_text":"import.meta.glob","href":null},{"type":"text","text":{"content":"を使うやり方では問題なく動作した。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"を使うやり方では問題なく動作した。","href":null}],"color":"default"}},{"object":"block","id":"b8820967-6b42-44a0-813e-ca9f9caf5897","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T06:05:00.000Z","last_edited_time":"2023-12-27T06:06:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[{"type":"text","text":{"content":"ということで、Astroのビルド時に画像の幅・高さの設定とwebpへの最適化、遅延読み込みの有効化などが自動的に行われるようになった。めでたしめでたし。","link":null},"annotations":{"bold":false,"italic":false,"strikethrough":false,"underline":false,"code":false,"color":"default"},"plain_text":"ということで、Astroのビルド時に画像の幅・高さの設定とwebpへの最適化、遅延読み込みの有効化などが自動的に行われるようになった。めでたしめでたし。","href":null}],"color":"default"}},{"object":"block","id":"6ee979f3-981b-439d-8ae7-3e57a8497b35","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T06:02:00.000Z","last_edited_time":"2023-12-27T06:03:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"paragraph","paragraph":{"rich_text":[],"color":"default"}},{"object":"block","id":"0aaa7064-8a5b-414b-9306-f1f9292f9489","parent":{"type":"page_id","page_id":"a1bb976f-7cd0-4fd0-a892-7a6ada485f97"},"created_time":"2023-12-27T06:03:00.000Z","last_edited_time":"2023-12-27T06:05:00.000Z","created_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"last_edited_by":{"object":"user","id":"f4f222d4-d508-405d-ba6c-da82ee26ee54"},"has_children":false,"archived":false,"in_trash":false,"type":"image","image":{"caption":[],"type":"file","file":{"url":"https://prod-files-secure.s3.us-west-2.amazonaws.com/3c6255ea-b6c7-4055-8126-638d2819f0c3/2fc9b104-20e3-45fc-96eb-7b1b896aed99/001_2.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45HZZMZUHI%2F20240622%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20240622T003335Z&X-Amz-Expires=3600&X-Amz-Signature=e2e66d75db50fac0bd2975de3e5299731635f76e5766c339c66a75fccdc67772&X-Amz-SignedHeaders=host&x-id=GetObject","expiry_time":"2024-06-22T01:33:35.233Z"}}}]